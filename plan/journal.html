<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Journal App - Fixed Calendar</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="bg-gray-100 font-sans text-gray-800">

<div id="app" class="min-h-screen flex flex-col">
    <header class="bg-white shadow-sm p-4 mb-4">
        <h1 class="text-xl font-bold text-center md:text-left">Daily Journal</h1>
    </header>

    <main class="container mx-auto px-4 pb-8 flex-grow">
        <div class="hidden md:flex gap-6">
            <div class="w-1/3 bg-white p-6 rounded-lg shadow-md h-fit">
                <div class="flex gap-2 mb-4">
                    <select v-model="selectedMonth" class="border rounded p-2 flex-1 focus:ring-2 focus:ring-blue-500 cursor-pointer">
                        <option v-for="(m, index) in months" :key="index" :value="index">{{ m }}</option>
                    </select>
                    <select v-model="selectedYear" class="border rounded p-2 flex-1 focus:ring-2 focus:ring-blue-500 cursor-pointer">
                        <option v-for="y in years" :key="y" :value="y">{{ y }}</option>
                    </select>
                </div>

                <div class="grid grid-cols-7 gap-1 text-center border p-2 rounded bg-gray-50">
                    <div v-for="(day, index) in daysOfWeek" :key="day"
                         :class="['text-xs font-bold py-2 uppercase', (index === 0 || index === 6) ? 'text-red-500' : 'text-gray-500']">
                        {{ day }}
                    </div>

                    <div v-for="blank in firstDayOffset" :key="'blank-'+blank" class="p-2"></div>

                    <button
                        v-for="date in daysInMonth"
                        :key="date"
                        @click="selectedDay = date"
                        :class="[
                            'p-2 rounded text-sm transition font-medium relative',
                            selectedDay === date ? 'bg-indigo-600 text-white z-10 shadow' : 'hover:bg-indigo-50',
                            (isWeekend(date) && selectedDay !== date) ? 'text-red-500' : ''
                        ]"
                    >
                        {{ date }}
                    </button>
                </div>
            </div>

            <div class="w-2/3 flex flex-col gap-4">
                <div class="bg-white p-6 rounded-lg shadow-md flex-grow">
                    <h2 class="text-lg font-semibold mb-2 text-indigo-900 border-b pb-2">Catatan: {{ formattedDate }}</h2>
                    <textarea
                        v-model="note"
                        placeholder="Tulis catatan di sini..."
                        class="w-full h-96 p-4 border-none focus:outline-none focus:ring-0 resize-none text-gray-700 leading-relaxed"
                    ></textarea>
                </div>
                <button @click="saveNote" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg transition shadow-lg active:scale-95">
                    [cite_start]Simpan [cite: 6]
                </button>
            </div>
        </div>

        <div class="md:hidden flex flex-col gap-4">
            <div class="bg-white p-4 rounded-lg shadow flex justify-between items-center">
                <div class="flex gap-2 w-full">
                    <select v-model="selectedMonth" class="bg-transparent border-none font-bold text-lg focus:ring-0 outline-none">
                        <option v-for="(m, index) in months" :key="index" :value="index">{{ m }}</option>
                    </select>
                    <select v-model="selectedYear" class="bg-transparent border-none font-bold text-lg focus:ring-0 outline-none">
                        <option v-for="y in years" :key="y" :value="y">{{ y }}</option>
                    </select>
                </div>
                <span class="text-xs text-gray-400 font-mono">12:34</span> </div>

            <div class="flex overflow-x-auto gap-3 py-2 hide-scrollbar px-1">
                <button
                    v-for="date in daysInMonth"
                    :key="date"
                    @click="selectedDay = date"
                    :class="[
                        'flex-shrink-0 w-12 h-12 flex flex-col items-center justify-center rounded-xl border transition-all',
                        selectedDay === date ? 'bg-indigo-600 text-white border-indigo-600 shadow-md scale-110' : 'bg-white border-gray-200',
                        (isWeekend(date) && selectedDay !== date) ? 'text-red-500 border-red-100 bg-red-50' : ''
                    ]"
                >
                    <span class="text-[10px] uppercase opacity-70">{{ getDayName(date) }}</span>
                    <span class="font-bold text-sm">{{ date }}</span>
                </button>
            </div>

            <div class="bg-white p-4 rounded-lg shadow-md flex flex-col gap-4">
                <textarea
                    v-model="note"
                    placeholder="Tulis catatan hari ini..."
                    class="w-full h-80 p-3 border-b focus:outline-none focus:border-indigo-500 resize-none text-gray-700"
                ></textarea>
                <button @click="saveNote" class="bg-indigo-600 text-white py-4 rounded-xl font-bold active:scale-95 shadow-lg">
                    Simpan Perubahan
                </button>
            </div>
        </div>
    </main>
</div>

<script>
    const { createApp, ref, computed, watch } = Vue;

    createApp({
        setup() {
            const today = new Date();
            const selectedMonth = ref(today.getMonth());
            const selectedYear = ref(today.getFullYear());
            const selectedDay = ref(today.getDate());
            const note = ref("");

            const months = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
            const daysOfWeek = ['Min', 'Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab'];

            const years = computed(() => {
                const current = new Date().getFullYear();
                let arr = [];
                for(let i = current - 5; i <= current + 5; i++) arr.push(i);
                return arr;
            });

            // Menghitung jumlah hari dalam bulan terpilih
            const daysInMonth = computed(() => {
                return new Date(selectedYear.value, selectedMonth.value + 1, 0).getDate();
            });

            // Menghitung offset (hari apa tanggal 1 dimulai)
            const firstDayOffset = computed(() => {
                return new Date(selectedYear.value, selectedMonth.value, 1).getDay();
            });

            const isWeekend = (date) => {
                const day = new Date(selectedYear.value, selectedMonth.value, date).getDay();
                return day === 0 || day === 6;
            };

            const getDayName = (date) => {
                const dayIndex = new Date(selectedYear.value, selectedMonth.value, date).getDay();
                return daysOfWeek[dayIndex];
            };

            const formattedDate = computed(() => {
                return `${selectedDay.value} ${months[selectedMonth.value]} ${selectedYear.value}`;
            });

            const saveNote = () => {
                alert(`Tersimpan: Catatan untuk tanggal ${formattedDate.value}`);
            };

            // Reset hari jika pindah bulan dan tanggal tersebut tidak ada (misal dari 31 ke 30)
            watch([selectedMonth, selectedYear], () => {
                if (selectedDay.value > daysInMonth.value) {
                    selectedDay.value = daysInMonth.value;
                }
            });

            return {
                selectedMonth, selectedYear, selectedDay, note,
                months, years, daysOfWeek, daysInMonth, firstDayOffset,
                formattedDate, saveNote, isWeekend, getDayName
            }
        }
    }).mount('#app');
</script>

</body>
</html>
